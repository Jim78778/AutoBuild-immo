    - name: Merge swaiot.config - Fixed path
      run: |
        echo "Current directory before cd: $(pwd)"
        cd openwrt
        echo "Current directory after cd: $(pwd)"
        
        echo "=== Looking for swaiot.config ==="
        
        # 方法1: 从仓库根目录
        if [ -f "../swaiot.config" ]; then
          echo "Found swaiot.config at ../swaiot.config"
          echo "File content (first 10 lines):"
          head -10 ../swaiot.config
          cat ../swaiot.config >> .config
          echo "swaiot.config merged successfully"
          
        # 方法2: 从 workspace 根目录
        elif [ -f "../../swaiot.config" ]; then
          echo "Found swaiot.config at ../../swaiot.config"
          cat ../../swaiot.config >> .config
          echo "swaiot.config merged successfully"
          
        # 方法3: 检查当前目录
        elif [ -f "swaiot.config" ]; then
          echo "Found swaiot.config in openwrt directory"
          cat swaiot.config >> .config
          echo "swaiot.config merged successfully"
          
        # 方法4: 搜索整个工作区
        else
          echo "swaiot.config not found in expected locations"
          echo "Searching in workspace..."
          
          # 回到初始目录搜索
          cd ..
          SWAIOT_PATH=$(find . -name "swaiot.config" -type f | head -1)
          
          if [ -n "$SWAIOT_PATH" ]; then
            echo "Found swaiot.config at: $SWAIOT_PATH"
            cd openwrt
            cat "../$SWAIOT_PATH" >> .config
            echo "swaiot.config merged from $SWAIOT_PATH"
          else
            echo "WARNING: swaiot.config not found anywhere!"
            echo "Creating basic swaiot.config for MHI support..."
            
            # 修正：完整的 heredoc 语法
            cat > swaiot.config << 'EOF'
# Basic MHI/QModem configuration for CPE-S10
CONFIG_PACKAGE_kmod-mhi-bus=y
CONFIG_PACKAGE_kmod-mhi-wwan=y
CONFIG_PACKAGE_kmod-mhi-pci-generic=y
CONFIG_PACKAGE_kmod-qrtr=y
CONFIG_PACKAGE_kmod-qrtr-mhi=y
CONFIG_PACKAGE_libqmi=y
CONFIG_PACKAGE_qmicli=y
CONFIG_PACKAGE_libmbim=y
CONFIG_PACKAGE_mbimcli=y

# Network
CONFIG_PACKAGE_kmod-nss-drv=y
CONFIG_PACKAGE_kmod-qca-nss-drv=y

# Base system
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_fstools=y
CONFIG_PACKAGE_uclient-fetch=y
CONFIG_PACKAGE_curl=y
EOF
            
            cat swaiot.config >> .config
            echo "Created and merged basic swaiot.config"
          fi
        fi
