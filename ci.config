# ===============================
# Core
# ===============================
CONFIG_MODULES=y
CONFIG_HAVE_DOT_CONFIG=y
CONFIG_HOST_OS_LINUX=y
CONFIG_TARGET_ARCH_PACKAGES="aarch64_cortex-a53"
CONFIG_ARCH_64BIT=y
CONFIG_aarch64=y
CONFIG_ARCH="aarch64"

# ===============================
# Target
# ===============================
CONFIG_TARGET_qualcommax=y
CONFIG_TARGET_qualcommax_ipq807x=y
CONFIG_TARGET_qualcommax_ipq807x_DEVICE_swaiot_cpe_s10=y
CONFIG_TARGET_BOARD="qualcommax"
CONFIG_TARGET_SUBTARGET="ipq807x"
CONFIG_TARGET_PROFILE="DEVICE_swaiot_cpe_s10"
CONFIG_CPU_TYPE="cortex-a53"
CONFIG_LINUX_6_12=y

# ===============================
# Filesystem
# ===============================
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=256
CONFIG_USES_SQUASHFS=y
# CONFIG_TARGET_ROOTFS_INITRAMFS is not set
# CONFIG_TARGET_INITRAMFS_COMPRESSION_ZSTD is not set


# ===============================
# PCI / MHI (CRITICAL FOR QMODEM)
# ===============================
CONFIG_PCI=y
CONFIG_PCIE_SUPPORT=y
CONFIG_KERNEL_PCI=y
CONFIG_KERNEL_PCI_MSI=y
CONFIG_KERNEL_PCIEPORTBUS=y

CONFIG_PACKAGE_kmod-mhi-bus=y
CONFIG_PACKAGE_kmod-mhi-pci-generic=y
CONFIG_PACKAGE_kmod-mhi-net=y
CONFIG_PACKAGE_kmod-mhi-wwan-ctrl=y
# CONFIG_PACKAGE_kmod-mhi-wwan-qmi is not set
CONFIG_PACKAGE_kmod-mhi-wwan-mbim=y
CONFIG_PACKAGE_kmod-qrtr=y
CONFIG_PACKAGE_kmod-qrtr-smd=y
CONFIG_PACKAGE_kmod-qcom-qmi-helpers=y

# ===============================
# qmodem stack
# ===============================
CONFIG_PACKAGE_qmodem=y
CONFIG_PACKAGE_luci-app-qmodem=y
CONFIG_PACKAGE_luci-app-qmodem_with_lua_index_page=y
CONFIG_PACKAGE_wwan=y
CONFIG_PACKAGE_uqmi=y
CONFIG_PACKAGE_qmicli=y
CONFIG_PACKAGE_mbimcli=y

# ===============================
# Disable USB WWAN (avoid conflict)
# ===============================
# CONFIG_PACKAGE_kmod-usb-net-qmi-wwan is not set
# CONFIG_PACKAGE_kmod-usb-net-cdc-mbim is not set

# ===============================
# NSS / ECM
# ===============================
CONFIG_PACKAGE_kmod-qca-nss-dp=y
CONFIG_PACKAGE_kmod-qca-nss-drv=y
# CONFIG_PACKAGE_kmod-qca-nss-ecm is not set
CONFIG_PACKAGE_kmod-qca-ssdk=y

CONFIG_NSS_DRV_BRIDGE_ENABLE=y
CONFIG_NSS_DRV_IPV6_ENABLE=y
CONFIG_NSS_DRV_PPE_ENABLE=y
CONFIG_NSS_DRV_PPPOE_ENABLE=y
CONFIG_NSS_DRV_VLAN_ENABLE=y
CONFIG_NSS_DRV_WIFI_ENABLE=y

# ===============================
# Wireless
# ===============================
CONFIG_PACKAGE_kmod-ath11k=y
CONFIG_PACKAGE_kmod-ath11k-ahb=y
CONFIG_PACKAGE_ath11k-firmware-ipq8074=y
CONFIG_PACKAGE_wireless-regdb=y
CONFIG_PACKAGE_wpad-openssl=y

# ===============================
# Networking base
# ===============================
CONFIG_PACKAGE_dnsmasq-full=y
CONFIG_PACKAGE_firewall=y
CONFIG_PACKAGE_ip-full=y
CONFIG_PACKAGE_ipset=y
CONFIG_PACKAGE_iptables=y
CONFIG_PACKAGE_iptables-mod-fullconenat=y
CONFIG_PACKAGE_iptables-mod-tproxy=y

# ===============================
# LuCI
# ===============================
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-base=y
CONFIG_PACKAGE_luci-mod-admin-full=y
CONFIG_PACKAGE_luci-mod-network=y
CONFIG_PACKAGE_luci-mod-status=y
CONFIG_PACKAGE_luci-mod-system=y

# ===============================
# System utils
# ===============================
CONFIG_PACKAGE_opkg=y
CONFIG_PACKAGE_dropbear=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget-ssl=y
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_nano=y

# ===============================
# Toolchain
# ===============================
CONFIG_USE_MUSL=y
CONFIG_GCC_VERSION="13.3.0"
CONFIG_BINUTILS_VERSION="2.40"
CONFIG_TARGET_OPTIMIZATION="-Os -pipe -mcpu=cortex-a53"
CONFIG_EXTRA_OPTIMIZATION="-fno-plt"
CONFIG_SSP_SUPPORT=y

# ===============================
# Feeds
# ===============================
CONFIG_FEED_packages=y
CONFIG_FEED_luci=y
CONFIG_FEED_routing=y
CONFIG_FEED_telephony=y
CONFIG_FEED_modem=y

# ===============================
# Override modem drivers
# ===============================
CONFIG_OVERRIDE_PKGS="fibocom_QMI_WWAN quectel_MHI quectel_QMI_WWAN"
